{% extends 'base.html' %}
{% block title %}Articles{% endblock %}
{% block content %}
<h1>Articles</h1>

{% if request.user.is_authenticated %}
    <a href="{% url 'articles:create' %}">ìƒˆ ê¸€ ì“°ê¸°</a>
{% else %}
    <a href="{% url 'accounts:login' %}">ë¡œê·¸ì¸í•˜ê³  ìƒˆ ê¸€ ì“°ê¸°</a>
{% endif %}

<ul>
  {% for article in articles %}
      <a href="{% url 'articles:article_detail' article.id %}">
          <br>
          <div>[ {{ article.id }} ] {{ article.title }}</div>
          <br>
      </a>

      <!-- íŒ”ë¡œìš° ë²„íŠ¼ -->
       {% if request.user.is_authenticated and request.user != article.author %}
        <form action="{% url 'accounts:follow' article.author.pk %}" method="POST">
            {% csrf_token %}
            {% if request.user in article.author.followers.all %}
                <input type="submit" value="ì–¸íŒ”ë¡œìš°">
            {% else %}
                <input type="submit" value="íŒ”ë¡œìš°">
            {% endif %}
        </form>
      {% endif %}  
      <!-- ì¢‹ì•„ìš” ë²„íŠ¼ : íŒ”ë¡œìš° ë²„íŠ¼ ë°”ë¡œ ì•„ë˜ ìœ„ì¹˜ -->
      {% if request.user.is_authenticated %}
          <form action="{% url 'articles:like' article.pk %}" method="POST" class="like-form">
              {% csrf_token %}
              <button type="submit" class="like-button">
                  {% if request.user in article.like_users.all %}
                      ğŸ’”
                  {% else %}
                      â¤ï¸
                  {% endif %}
              </button>
          </form>
          <div id="like-count-{{ article.pk }}">ì¢‹ì•„ìš” ìˆ˜: {{ article.like_count }}</div>
      {% else %}
          <div>ì¢‹ì•„ìš” ìˆ˜: {{ article.like_count }}</div>
          <a href="{% url 'accounts:login' %}?next={{ request.path }}" class="like-button">ì¢‹ì•„ìš”</a>
      {% endif %}

      <br>
  {% empty %}
      <p>ë“±ë¡ëœ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p>
  {% endfor %}
</ul>

{% endblock %}